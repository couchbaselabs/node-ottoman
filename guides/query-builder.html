<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Query Builder | Ottoman.js</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Ottoman is an ODM built for Couchbase and Node.js. ">
    
    <link rel="preload" href="/assets/css/0.styles.3356d12f.css" as="style"><link rel="preload" href="/assets/js/app.291b5b6b.js" as="script"><link rel="preload" href="/assets/js/2.91685ef8.js" as="script"><link rel="preload" href="/assets/js/107.62aaa79a.js" as="script"><link rel="prefetch" href="/assets/js/10.136756ed.js"><link rel="prefetch" href="/assets/js/100.fb2423b1.js"><link rel="prefetch" href="/assets/js/101.50fdf4f1.js"><link rel="prefetch" href="/assets/js/102.1b7ab3c7.js"><link rel="prefetch" href="/assets/js/103.34928fbb.js"><link rel="prefetch" href="/assets/js/104.4b4c876f.js"><link rel="prefetch" href="/assets/js/105.0da30cf6.js"><link rel="prefetch" href="/assets/js/106.8234ef85.js"><link rel="prefetch" href="/assets/js/108.71a63b5e.js"><link rel="prefetch" href="/assets/js/109.c704e77a.js"><link rel="prefetch" href="/assets/js/11.351d65d8.js"><link rel="prefetch" href="/assets/js/110.cc366c9f.js"><link rel="prefetch" href="/assets/js/111.ebd3cd06.js"><link rel="prefetch" href="/assets/js/112.7b7e5d12.js"><link rel="prefetch" href="/assets/js/113.8023b31e.js"><link rel="prefetch" href="/assets/js/114.af9f82b0.js"><link rel="prefetch" href="/assets/js/115.ff00a57f.js"><link rel="prefetch" href="/assets/js/12.0eaa72e8.js"><link rel="prefetch" href="/assets/js/13.2beef5cc.js"><link rel="prefetch" href="/assets/js/14.a357daab.js"><link rel="prefetch" href="/assets/js/15.e44949c8.js"><link rel="prefetch" href="/assets/js/16.baa697b1.js"><link rel="prefetch" href="/assets/js/17.d4e72a57.js"><link rel="prefetch" href="/assets/js/18.f5f0f403.js"><link rel="prefetch" href="/assets/js/19.cb21d330.js"><link rel="prefetch" href="/assets/js/20.cb7d8bcd.js"><link rel="prefetch" href="/assets/js/21.1d6dfbe2.js"><link rel="prefetch" href="/assets/js/22.a9692f88.js"><link rel="prefetch" href="/assets/js/23.e3576fb8.js"><link rel="prefetch" href="/assets/js/24.23375cf6.js"><link rel="prefetch" href="/assets/js/25.4460e2cd.js"><link rel="prefetch" href="/assets/js/26.df15fc34.js"><link rel="prefetch" href="/assets/js/27.2027d820.js"><link rel="prefetch" href="/assets/js/28.64ceb778.js"><link rel="prefetch" href="/assets/js/29.d9854cbb.js"><link rel="prefetch" href="/assets/js/3.c24dc5dc.js"><link rel="prefetch" href="/assets/js/30.8c3c235a.js"><link rel="prefetch" href="/assets/js/31.79e75bb3.js"><link rel="prefetch" href="/assets/js/32.66744c83.js"><link rel="prefetch" href="/assets/js/33.5f5841ec.js"><link rel="prefetch" href="/assets/js/34.4a4e28b8.js"><link rel="prefetch" href="/assets/js/35.0e4d66c9.js"><link rel="prefetch" href="/assets/js/36.4b90ba2f.js"><link rel="prefetch" href="/assets/js/37.868224e7.js"><link rel="prefetch" href="/assets/js/38.760e857f.js"><link rel="prefetch" href="/assets/js/39.0f6efda3.js"><link rel="prefetch" href="/assets/js/4.14b96c59.js"><link rel="prefetch" href="/assets/js/40.cab9a643.js"><link rel="prefetch" href="/assets/js/41.97ee4fca.js"><link rel="prefetch" href="/assets/js/42.e4dae5b2.js"><link rel="prefetch" href="/assets/js/43.361db389.js"><link rel="prefetch" href="/assets/js/44.efcb50d1.js"><link rel="prefetch" href="/assets/js/45.c6537402.js"><link rel="prefetch" href="/assets/js/46.fd53c8d8.js"><link rel="prefetch" href="/assets/js/47.2f383dd7.js"><link rel="prefetch" href="/assets/js/48.4e0eb494.js"><link rel="prefetch" href="/assets/js/49.066a74e7.js"><link rel="prefetch" href="/assets/js/5.72d44663.js"><link rel="prefetch" href="/assets/js/50.58f5ad8c.js"><link rel="prefetch" href="/assets/js/51.9ec5bd2c.js"><link rel="prefetch" href="/assets/js/52.d57fe916.js"><link rel="prefetch" href="/assets/js/53.e1b5b3ad.js"><link rel="prefetch" href="/assets/js/54.99e52fb4.js"><link rel="prefetch" href="/assets/js/55.d5648595.js"><link rel="prefetch" href="/assets/js/56.78341efa.js"><link rel="prefetch" href="/assets/js/57.c565adca.js"><link rel="prefetch" href="/assets/js/58.b0629b92.js"><link rel="prefetch" href="/assets/js/59.6dd7aa3e.js"><link rel="prefetch" href="/assets/js/6.0a7e9a10.js"><link rel="prefetch" href="/assets/js/60.557f0fc8.js"><link rel="prefetch" href="/assets/js/61.4555d956.js"><link rel="prefetch" href="/assets/js/62.eb19446c.js"><link rel="prefetch" href="/assets/js/63.c8a3a557.js"><link rel="prefetch" href="/assets/js/64.6dc8b596.js"><link rel="prefetch" href="/assets/js/65.85b50252.js"><link rel="prefetch" href="/assets/js/66.84f972af.js"><link rel="prefetch" href="/assets/js/67.0ca1c3e9.js"><link rel="prefetch" href="/assets/js/68.df8ce023.js"><link rel="prefetch" href="/assets/js/69.77b0b603.js"><link rel="prefetch" href="/assets/js/7.fbd42597.js"><link rel="prefetch" href="/assets/js/70.3d929597.js"><link rel="prefetch" href="/assets/js/71.172451fc.js"><link rel="prefetch" href="/assets/js/72.01f72b87.js"><link rel="prefetch" href="/assets/js/73.8b9345d4.js"><link rel="prefetch" href="/assets/js/74.d83df257.js"><link rel="prefetch" href="/assets/js/75.3eff604e.js"><link rel="prefetch" href="/assets/js/76.076a3437.js"><link rel="prefetch" href="/assets/js/77.60b3017f.js"><link rel="prefetch" href="/assets/js/78.5ce41afc.js"><link rel="prefetch" href="/assets/js/79.3067f233.js"><link rel="prefetch" href="/assets/js/8.dbb9107b.js"><link rel="prefetch" href="/assets/js/80.470f4128.js"><link rel="prefetch" href="/assets/js/81.bcdee74b.js"><link rel="prefetch" href="/assets/js/82.157ec86d.js"><link rel="prefetch" href="/assets/js/83.6cae5767.js"><link rel="prefetch" href="/assets/js/84.f2510e86.js"><link rel="prefetch" href="/assets/js/85.93a29d2c.js"><link rel="prefetch" href="/assets/js/86.8a4b7181.js"><link rel="prefetch" href="/assets/js/87.16664c7a.js"><link rel="prefetch" href="/assets/js/88.cc9a952e.js"><link rel="prefetch" href="/assets/js/89.33ff65d5.js"><link rel="prefetch" href="/assets/js/9.938b3bc4.js"><link rel="prefetch" href="/assets/js/90.17282026.js"><link rel="prefetch" href="/assets/js/91.24a475d4.js"><link rel="prefetch" href="/assets/js/92.568f3a5a.js"><link rel="prefetch" href="/assets/js/93.9a37560f.js"><link rel="prefetch" href="/assets/js/94.00852809.js"><link rel="prefetch" href="/assets/js/95.7d5b10e2.js"><link rel="prefetch" href="/assets/js/96.8a773950.js"><link rel="prefetch" href="/assets/js/97.c97a5124.js"><link rel="prefetch" href="/assets/js/98.f0b46a96.js"><link rel="prefetch" href="/assets/js/99.146f2756.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3356d12f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Ottoman.js</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/faq.html" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/guides/mongoose-to-couchbase.html" class="nav-link">
  Mongoose to Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottoman-couchbase.html" class="nav-link">
  Ottoman for Couchbase Node.js SDK devs
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottomanV1-to-ottomanV2.html" class="nav-link">
  Ottoman V1 to Ottoman V2
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/guides/faq.html" class="nav-link">
  FAQ
</a></div><div class="nav-item"><a href="/guides/quick-start.html" class="nav-link">
  Quick Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Basic" class="dropdown-title"><span class="title">Basic</span> <span class="arrow down"></span></button> <button type="button" aria-label="Basic" class="mobile-dropdown-title"><span class="title">Basic</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guides/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/guides/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/guides/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/guides/query-builder.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Query Builder
</a></li><li class="dropdown-item"><!----> <a href="/guides/mongoose-to-couchbase.html" class="nav-link">
  Mongoose to Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottoman-couchbase.html" class="nav-link">
  Ottoman for Couchbase Node.js SDK devs
</a></li><li class="dropdown-item"><!----> <a href="/guides/ottomanV1-to-ottomanV2.html" class="nav-link">
  Ottoman V1 to Ottoman V2
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Advanced" class="dropdown-title"><span class="title">Advanced</span> <span class="arrow down"></span></button> <button type="button" aria-label="Advanced" class="mobile-dropdown-title"><span class="title">Advanced</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/how-ottoman-works.html" class="nav-link">
  How Ottoman Works
</a></li><li class="dropdown-item"><!----> <a href="/advanced/ottoman.html" class="nav-link">
  Ottoman
</a></li></ul></div></div><div class="nav-item"><a href="/guides/first-app.html" class="nav-link">
  Example
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><span class="title">API</span> <span class="arrow down"></span></button> <button type="button" aria-label="API" class="mobile-dropdown-title"><span class="title">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/classes/ottoman.html" class="nav-link">
  Ottoman
</a></li><li class="dropdown-item"><!----> <a href="/classes/schema.html" class="nav-link">
  Schema
</a></li><li class="dropdown-item"><!----> <a href="/classes/model.html" class="nav-link">
  Model
</a></li><li class="dropdown-item"><!----> <a href="/classes/document.html" class="nav-link">
  Document
</a></li><li class="dropdown-item"><!----> <a href="/classes/query.html" class="nav-link">
  Query Builder
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/couchbaselabs/node-ottoman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Query Builder</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guides/query-builder.html#using-the-query-builder" class="sidebar-link">Using the Query Builder</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-parameters" class="sidebar-link">Build a Query by Using Parameters</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-access-functions" class="sidebar-link">Build a Query by Using Access Functions</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#build-a-query-by-using-parameters-and-function-parameters" class="sidebar-link">Build a Query by Using Parameters and Function Parameters</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#advanced-example-of-using-the-where-clause" class="sidebar-link">Advanced Example of Using the WHERE Clause</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-select-clause-structure" class="sidebar-link">N1QL SELECT Clause Structure</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#available-result-expression-arguments" class="sidebar-link">Available Result Expression Arguments</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#available-aggregation-functions" class="sidebar-link">Available Aggregation Functions</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#n1ql-select-nested-clause-example" class="sidebar-link">N1QL SELECT Nested Clause Example</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-where-clause-structure" class="sidebar-link">N1QL WHERE Clause Structure</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#available-comparison-operators" class="sidebar-link">Available Comparison Operators</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#available-logical-operators" class="sidebar-link">Available Logical Operators</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#available-collection-operators" class="sidebar-link">Available Collection Operators</a></li></ul></li><li><a href="/guides/query-builder.html#functional-collection-operators-examples" class="sidebar-link">Functional COLLECTION Operators Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guides/query-builder.html#using-deep-search-operators-not-in-within" class="sidebar-link">Using Deep Search Operators ( [NOT] IN | WITHIN )</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#using-range-predicate-operators-any-every" class="sidebar-link">Using Range Predicate Operators ( ANY | EVERY )</a></li><li class="sidebar-sub-header"><a href="/guides/query-builder.html#query-builder-model-find-method" class="sidebar-link">Query Builder &amp; Model Find Method</a></li></ul></li><li><a href="/guides/query-builder.html#n1ql-join-clause-structure" class="sidebar-link">N1QL JOIN Clause Structure</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/guides/query-builder.html#n1ql-group-by-clause-structure" class="sidebar-link">N1QL GROUP BY Clause Structure</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="query-builder"><a href="#query-builder" class="header-anchor">#</a> Query Builder</h1> <p><a href="/classes/query.html">Query Builder</a> is a flexible tool designed to create N1QL queries by specifying parameters and methods. Query Builder lets you: create queries of unlimited length and complexity without the need to know the syntax of N1QL Queries.</p> <h2 id="using-the-query-builder"><a href="#using-the-query-builder" class="header-anchor">#</a> Using the Query Builder</h2> <p>There are 3 ways to use the Query Builder: by using parameters, by using access functions, or by combining both.</p> <h3 id="build-a-query-by-using-parameters"><a href="#build-a-query-by-using-parameters" class="header-anchor">#</a> Build a Query by Using Parameters</h3> <p>To create queries by using parameters it is mandatory to define in the query constructor the <a href="/interfaces/iconditionexpr.html#hierarchy"><strong>parameters</strong></a> of the query and the <strong>name</strong> of the collection.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
  select<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      $count<span class="token operator">:</span> <span class="token punctuation">{</span>
        $field<span class="token operator">:</span> <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'odm'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token keyword">let</span><span class="token operator">:</span> <span class="token punctuation">{</span> amount_val<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> size_val<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  where<span class="token operator">:</span> <span class="token punctuation">{</span>
    $or<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    $and<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        $or<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    $<span class="token builtin">any</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      $expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> search<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span> search<span class="token operator">:</span> <span class="token string">'10'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    search<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'address'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  groupBy<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> expr<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'sch'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  letting<span class="token operator">:</span> <span class="token punctuation">{</span> amount_v2<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> size_v2<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  having<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%hotel%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  orderBy<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'DESC'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  limit<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  offset<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'airline_8093'</span><span class="token punctuation">,</span> <span class="token string">'airline_8094'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> odm
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span><span class="token punctuation">.</span>_default<span class="token punctuation">.</span>_default
 <span class="token keyword">USE</span> <span class="token keyword">KEYS</span> <span class="token punctuation">[</span><span class="token string">&quot;airline_8093&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;airline_8094&quot;</span><span class="token punctuation">]</span>
 LET amount_val<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> size_val<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price <span class="token operator">&gt;</span> <span class="token string">&quot;amount_val&quot;</span>
  <span class="token operator">AND</span> price <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
  <span class="token operator">OR</span> auto <span class="token operator">&gt;</span> <span class="token number">10</span>
  <span class="token operator">OR</span> amount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price2 <span class="token operator">&gt;</span> <span class="token number">1.99</span>
  <span class="token operator">AND</span> price2 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price3 <span class="token operator">&gt;</span> <span class="token number">1.99</span>
    <span class="token operator">AND</span> price3 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
    <span class="token operator">OR</span> id <span class="token operator">=</span> <span class="token string">&quot;20&quot;</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>LOWER<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=</span> LOWER<span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token keyword">ANY</span> search <span class="token operator">IN</span> address SATISFIES address <span class="token operator">=</span> <span class="token string">&quot;10&quot;</span> <span class="token keyword">END</span>
  <span class="token operator">AND</span> search <span class="token operator">IN</span> <span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">]</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">type</span> <span class="token keyword">AS</span> sch LETTING amount_v2<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> size_v2<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">HAVING</span> <span class="token keyword">type</span> <span class="token operator">LIKE</span> <span class="token string">&quot;%hotel%&quot;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">type</span> <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span>
</code></pre></div><h3 id="build-a-query-by-using-access-functions"><a href="#build-a-query-by-using-access-functions" class="header-anchor">#</a> Build a Query by Using Access Functions</h3> <p>Creating queries by using the access function is very similar to create them with parameters. The difference is that the parameters are not passed directly to the constructor, instead, they are passed using the different functions available in the Query Class.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    $count<span class="token operator">:</span> <span class="token punctuation">{</span>
      $field<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'type'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'odm'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    $max<span class="token operator">:</span> <span class="token punctuation">{</span>
      $field<span class="token operator">:</span> <span class="token string">'amount'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> letExpr <span class="token operator">=</span> <span class="token punctuation">{</span> amount_val<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> size_val<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'amount_val'</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> auto<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> amount<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> price2<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      $or<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> price3<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">1.99</span><span class="token punctuation">,</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'20'</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> groupBy <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> expr<span class="token operator">:</span> <span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'sch'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> having <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%hotel%'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> lettingExpr <span class="token operator">=</span> <span class="token punctuation">{</span> amount_v2<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> size_v2<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> orderBy <span class="token operator">=</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'DESC'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> limit <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> offset <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> useExpr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'airline_8093'</span><span class="token punctuation">,</span> <span class="token string">'airline_8094'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'collection-name'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">let</span><span class="token punctuation">(</span>letExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">groupBy</span><span class="token punctuation">(</span>groupBy<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">letting</span><span class="token punctuation">(</span>lettingExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">having</span><span class="token punctuation">(</span>having<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">orderBy</span><span class="token punctuation">(</span>orderBy<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">offset</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">useKeys</span><span class="token punctuation">(</span>useExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> odm<span class="token punctuation">,</span> <span class="token function">MAX</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span> <span class="token keyword">USE</span> <span class="token keyword">KEYS</span> <span class="token punctuation">[</span><span class="token string">'airline_8093'</span><span class="token punctuation">,</span><span class="token string">'airline_8094'</span><span class="token punctuation">]</span>
  LET amount_val <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> size_val <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price <span class="token operator">&gt;</span> amount_val
  <span class="token operator">AND</span> price <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
  <span class="token operator">OR</span> auto <span class="token operator">&gt;</span> <span class="token number">10</span>
  <span class="token operator">OR</span> amount <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price2 <span class="token operator">&gt;</span> <span class="token number">1.99</span>
  <span class="token operator">AND</span> price2 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>price3 <span class="token operator">&gt;</span> <span class="token number">1.99</span>
    <span class="token operator">AND</span> price3 <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">)</span>
    <span class="token operator">OR</span> id <span class="token operator">=</span> <span class="token string">'20'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> <span class="token keyword">type</span> <span class="token keyword">AS</span> sch LETTING amount_v2<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> size_v2<span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">HAVING</span> <span class="token keyword">type</span> <span class="token operator">LIKE</span> <span class="token string">&quot;%hotel%&quot;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">'DESC'</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span> <span class="token keyword">OFFSET</span> <span class="token number">1</span>
</code></pre></div><h3 id="build-a-query-by-using-parameters-and-function-parameters"><a href="#build-a-query-by-using-parameters-and-function-parameters" class="header-anchor">#</a> Build a Query by Using Parameters and Function Parameters</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> select <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> where<span class="token operator">:</span> <span class="token punctuation">{</span> price<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>select<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span> address
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span> price <span class="token operator">&gt;</span> <span class="token number">5</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre></div><h3 id="advanced-example-of-using-the-where-clause"><a href="#advanced-example-of-using-the-where-clause" class="header-anchor">#</a> Advanced Example of Using the WHERE Clause</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token punctuation">{</span> $isMissing<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotValued<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token number">8000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $neq<span class="token operator">:</span> <span class="token number">9000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token number">7000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $gte<span class="token operator">:</span> <span class="token number">6999</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $lt<span class="token operator">:</span> <span class="token number">5000</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $lte<span class="token operator">:</span> <span class="token number">4999</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotMissing<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $isValued<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  $not<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%59%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token punctuation">{</span> $notLike<span class="token operator">:</span> <span class="token string">'Otto%'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      $or<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $btw<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token punctuation">{</span> $notBtw<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">2001</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'St%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>address <span class="token operator">IS</span> <span class="token boolean">NULL</span>
  <span class="token operator">OR</span> free_breakfast <span class="token operator">IS</span> MISSING
  <span class="token operator">OR</span> free_breakfast <span class="token operator">IS</span> <span class="token operator">NOT</span> VALUED
  <span class="token operator">OR</span> id <span class="token operator">=</span> <span class="token number">8000</span>
  <span class="token operator">OR</span> id <span class="token operator">!=</span> <span class="token number">9000</span>
  <span class="token operator">OR</span> id <span class="token operator">&gt;</span> <span class="token number">7000</span>
  <span class="token operator">OR</span> id <span class="token operator">&gt;=</span> <span class="token number">6999</span>
  <span class="token operator">OR</span> id <span class="token operator">&lt;</span> <span class="token number">5000</span>
  <span class="token operator">OR</span> id <span class="token operator">&lt;=</span> <span class="token number">4999</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>address <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
  <span class="token operator">AND</span> address <span class="token operator">IS</span> <span class="token operator">NOT</span> MISSING
  <span class="token operator">AND</span> address <span class="token operator">IS</span> VALUED<span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token operator">NOT</span> <span class="token punctuation">(</span>address <span class="token operator">LIKE</span> <span class="token string">&quot;%59%&quot;</span>
  <span class="token operator">AND</span> name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">&quot;Otto%&quot;</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>id <span class="token operator">BETWEEN</span> <span class="token number">1</span> <span class="token operator">AND</span> <span class="token number">2000</span>
    <span class="token operator">OR</span> id <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">2001</span> <span class="token operator">AND</span> <span class="token number">8000</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>LOWER<span class="token punctuation">(</span>address<span class="token punctuation">)</span> <span class="token operator">LIKE</span> LOWER<span class="token punctuation">(</span><span class="token string">&quot;St%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">LIMIT</span> <span class="token number">20</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Note</p> <p>Can also use <code>ignoreCase</code> as part of the <code>build</code> method, this will always prioritize the <code>$ignoreCase</code> value defined in clause</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> expr_where <span class="token operator">=</span> <span class="token punctuation">{</span>
  $or<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> address<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'%57-59%'</span><span class="token punctuation">,</span> $ignoreCase<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// ignoreCase not applied</span>
    <span class="token punctuation">{</span> free_breakfast<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'John'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token comment">//  ignoreCase applied</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * Can also use:
 * const expr_where = {
 *   $or: [
 *     ...
 *     { name: 'John' } // ignoreCase applied
 *   ],
 * };
 *
 */</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> query
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'address'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>expr_where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span> ignoreCase<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ignoreCase enabled for WHERE clause</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</code></pre></div><p>Would have as output:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token comment">-- N1QL query result:</span>
<span class="token keyword">SELECT</span> address
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span> <span class="token punctuation">(</span>address <span class="token operator">LIKE</span> <span class="token string">&quot;%57-59%&quot;</span>
  <span class="token operator">OR</span> free_breakfast <span class="token operator">=</span> <span class="token boolean">TRUE</span>
  <span class="token operator">OR</span> <span class="token punctuation">(</span>LOWER<span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=</span> LOWER<span class="token punctuation">(</span><span class="token string">&quot;John&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <h2 id="n1ql-select-clause-structure"><a href="#n1ql-select-clause-structure" class="header-anchor">#</a> N1QL SELECT Clause Structure</h2> <p>See definition <a href="/classes/query.html#select">here</a></p> <p>The syntax of a SELECT clause in n1ql is documented <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/select-syntax.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="available-result-expression-arguments"><a href="#available-result-expression-arguments" class="header-anchor">#</a> Available Result Expression Arguments</h3> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$all</td> <td>ALL</td></tr> <tr><td>$distinct</td> <td>DISTINCT</td></tr> <tr><td>$raw</td> <td>RAW</td></tr> <tr><td>$element</td> <td>ELEMENT</td></tr> <tr><td>$value</td> <td>VALUE</td></tr></tbody></table> <h3 id="available-aggregation-functions"><a href="#available-aggregation-functions" class="header-anchor">#</a> Available Aggregation Functions</h3> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$arrayAgg</td> <td>ARRAY_AGG</td></tr> <tr><td>$avg</td> <td>AVG</td></tr> <tr><td>$mean</td> <td>MEAN</td></tr> <tr><td>$count</td> <td>COUNT</td></tr> <tr><td>$countn</td> <td>COUNTN</td></tr> <tr><td>$max</td> <td>MAX</td></tr> <tr><td>$median</td> <td>MEDIAN</td></tr> <tr><td>$min</td> <td>MIN</td></tr> <tr><td>$stddev</td> <td>STDDEV</td></tr> <tr><td>$stddevPop</td> <td>STDDEV_POP</td></tr> <tr><td>$stddevSamp</td> <td>STDDEV_SAMP</td></tr> <tr><td>$sum</td> <td>SUM</td></tr> <tr><td>$variance</td> <td>VARIANCE</td></tr> <tr><td>$variancePop</td> <td>VARIANCE_POP</td></tr> <tr><td>$varianceSamp</td> <td>VARIANCE_SAMP</td></tr> <tr><td>$varPop</td> <td>VAR_SAMP</td></tr> <tr><td>$varSamp</td> <td>VAR_SAMP</td></tr></tbody></table> <h3 id="n1ql-select-nested-clause-example"><a href="#n1ql-select-nested-clause-example" class="header-anchor">#</a> N1QL SELECT Nested Clause Example</h3> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> query
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
    $field<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'{ &quot;latLon&quot;: { geo.lat, geo.lon } }'</span><span class="token punctuation">,</span>
      <span class="token keyword">as</span><span class="token operator">:</span> <span class="token string">'geo'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'a.type'</span><span class="token operator">:</span> <span class="token string">'hotel'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> {<span class="token string">&quot;latLon&quot;</span>: {geo<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> geo<span class="token punctuation">.</span>lon} } <span class="token keyword">AS</span> geo
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span> a
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span><span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&quot;hotel&quot;</span>
</code></pre></div><h2 id="n1ql-where-clause-structure"><a href="#n1ql-where-clause-structure" class="header-anchor">#</a> N1QL WHERE Clause Structure</h2> <p>See definition <a href="/classes/query.html#where">here</a></p> <p>The syntax of a WHERE clause in N1QL is documented <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/where.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h3 id="available-comparison-operators"><a href="#available-comparison-operators" class="header-anchor">#</a> Available Comparison Operators</h3> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$isNull</td> <td>IS NULL</td></tr> <tr><td>$isNotNull</td> <td>IS NOT NULL</td></tr> <tr><td>$isMissing</td> <td>IS MISSING</td></tr> <tr><td>$isNotMissing</td> <td>IS NOT MISSING</td></tr> <tr><td>$isValued</td> <td>IS VALUED</td></tr> <tr><td>$isNotValued</td> <td>IS NOT VALUED</td></tr> <tr><td>$eq</td> <td>=</td></tr> <tr><td>$neq</td> <td>!=</td></tr> <tr><td>$gt</td> <td>&gt;</td></tr> <tr><td>$gte</td> <td>&gt;=</td></tr> <tr><td>$lt</td> <td>&lt;</td></tr> <tr><td>$lte</td> <td>&lt;=</td></tr> <tr><td>$like</td> <td>LIKE</td></tr> <tr><td>$notLike</td> <td>NOT LIKE</td></tr> <tr><td>$btw</td> <td>BETWEEN</td></tr> <tr><td>$notBtw</td> <td>NOT BETWEEN</td></tr></tbody></table> <h3 id="available-logical-operators"><a href="#available-logical-operators" class="header-anchor">#</a> Available Logical Operators</h3> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$and</td> <td>AND</td></tr> <tr><td>$or</td> <td>OR</td></tr> <tr><td>$not</td> <td>NOT</td></tr></tbody></table> <h3 id="available-collection-operators"><a href="#available-collection-operators" class="header-anchor">#</a> Available Collection Operators</h3> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$any</td> <td>ANY</td></tr> <tr><td>$every</td> <td>EVERY</td></tr> <tr><td>$in</td> <td>IN</td></tr> <tr><td>$notIn</td> <td>NOT IN</td></tr> <tr><td>$within</td> <td>WITHIN</td></tr> <tr><td>$notWithin</td> <td>NOT WITHIN</td></tr> <tr><td>$satisfies</td> <td>SATISFIES</td></tr></tbody></table> <p>Available String Modifiers:</p> <table><thead><tr><th>key</th> <th>value</th></tr></thead> <tbody><tr><td>$ignoreCase</td> <td>Boolean</td></tr></tbody></table> <h2 id="functional-collection-operators-examples"><a href="#functional-collection-operators-examples" class="header-anchor">#</a> Functional <em>COLLECTION</em> Operators Examples</h2> <p>Let's take a deeper dive into using various collection operators with Ottoman's Query Builder</p> <h3 id="using-deep-search-operators-not-in-within"><a href="#using-deep-search-operators-not-in-within" class="header-anchor">#</a> Using Deep Search Operators <em>( [NOT] IN | WITHIN )</em></h3> <p>The <a href="/guides/(https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/collectionops.html#collection-op-in)">IN</a> operator specifies the search depth to <em>include</em> <em><strong>only</strong></em> <em>the current level of an array and</em> <em><strong>not</strong></em> <em>to include any child or descendant arrays</em>. On the other hand the <a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/collectionops.html#collection-op-within" target="_blank" rel="noopener noreferrer">WITHIN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> operator <em>include the current level of an array and</em> <em><strong>all</strong></em> <em>of its child and descendant arrays</em>.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Defining our where clause</span>
<span class="token keyword">const</span> where<span class="token operator">:</span> LogicalWhereExpr <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token string">'airline'</span><span class="token punctuation">,</span>
  country<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'United Kingdom'</span><span class="token punctuation">,</span> <span class="token string">'France'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;CORSAIR&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token punctuation">{</span> $within<span class="token operator">:</span> <span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'t'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">travel-sample t</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">'name,country,id'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>where<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>With the above implementation will get this sql query:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> name<span class="token punctuation">,</span> country<span class="token punctuation">,</span> id
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span> t
<span class="token keyword">WHERE</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&quot;airline&quot;</span>
  <span class="token operator">AND</span> country <span class="token operator">IN</span> <span class="token punctuation">[</span><span class="token string">&quot;United Kingdom&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;France&quot;</span><span class="token punctuation">]</span>
  <span class="token operator">AND</span> <span class="token string">&quot;CORSAIR&quot;</span> <span class="token keyword">WITHIN</span> t<span class="token punctuation">;</span>
</code></pre></div><p>Now we call to Ottoman instance</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token function">getDefaultInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Query execution</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Here is the output:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    country: <span class="token string">'France'</span>,
    id: <span class="token number">1908</span>,
    name: <span class="token string">'Corsairfly'</span>,
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><h3 id="using-range-predicate-operators-any-every"><a href="#using-range-predicate-operators-any-every" class="header-anchor">#</a> Using Range Predicate Operators <em>( ANY | EVERY )</em></h3> <p><a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/collectionops.html#collection-op-any" target="_blank" rel="noopener noreferrer">ANY<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is a range predicate that tests a Boolean condition over the elements or attributes of a collection, object, or objects. It uses the <code>IN</code> and <code>WITHIN</code> operators to range through the collection. If at least one item in the array satisfies the <code>ANY</code> expression, then it returns the entire array; otherwise, it returns an empty array. Let's see it in action:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Defining our selection</span>
<span class="token keyword">const</span> selectExpr <span class="token operator">=</span> <span class="token string">'airline,airlineid,destinationairport,distance'</span><span class="token punctuation">;</span>

<span class="token comment">// Using LET operator to store some data</span>
<span class="token keyword">const</span> letExpr<span class="token operator">:</span> LetExprType <span class="token operator">=</span> <span class="token punctuation">{</span> destination<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ATL'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>For <code>ANY</code> and <code>EVERY</code> in Ottoman we use the operators <code>$expr</code> and <code>$satisfies</code>:</p> <blockquote><p><em><strong>$expr:</strong></em> is an array of expressions with the structure: <br> <code>[{ SEARCH_EXPRESSION: { [$in|$within]: TARGET_EXPRESSION } }]</code></p> <ul><li><em><code>SEARCH_EXPRESSION</code></em>: A string or expression that evaluates to a string representing the variable name in the <code>ANY | EVERY</code> loop.</li> <li><em><code>TARGET_EXPRESSION</code></em>: A string or expression that evaluates to a string representing the array to loop through.</li></ul> <p><em><strong>$satisfies:</strong></em> An expression representing the limiting or matching clause to test against</p></blockquote> <p>Now we create the <code>WHERE</code> clause including the <code>ANY</code> operator:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> whereExpr<span class="token operator">:</span> LogicalWhereExpr <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'route'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> sourceairport<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'ABQ'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token comment">// Here is where the magic happen</span>
      $<span class="token builtin">any</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        $expr<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span> departure<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token string">'schedule'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> other<span class="token operator">:</span> <span class="token punctuation">{</span> $within<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'KL'</span><span class="token punctuation">,</span> <span class="token string">'AZ'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span>
          $and<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span> <span class="token string">'departure.utc'</span><span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'03:53'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span> other<span class="token operator">:</span> <span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'airline'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> destinationairport<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'destination'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>selectExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">let</span><span class="token punctuation">(</span>letExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>whereExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We will obtain the query:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> airline<span class="token punctuation">,</span> airlineid<span class="token punctuation">,</span> destinationairport<span class="token punctuation">,</span> distance
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
LET destination<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;ATL&quot;</span><span class="token punctuation">]</span>
<span class="token keyword">WHERE</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&quot;route&quot;</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>
    sourceairport <span class="token operator">=</span> <span class="token string">&quot;ABQ&quot;</span>
    <span class="token operator">AND</span> <span class="token keyword">ANY</span> departure <span class="token operator">IN</span> schedule<span class="token punctuation">,</span>
    other <span class="token keyword">WITHIN</span> <span class="token punctuation">[</span><span class="token string">&quot;KL&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;AZ&quot;</span><span class="token punctuation">]</span>
    SATISFIES <span class="token punctuation">(</span>
        departure<span class="token punctuation">.</span>utc <span class="token operator">&gt;</span> <span class="token string">&quot;03:53&quot;</span> <span class="token operator">AND</span> other <span class="token operator">=</span> airline
    <span class="token punctuation">)</span> <span class="token keyword">END</span>
    <span class="token operator">AND</span> destinationairport <span class="token operator">IN</span> destination<span class="token punctuation">)</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token function">getDefaultInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// After initializing Ottoman we run the query</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> rows <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The query output:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    airline: <span class="token string">'AZ'</span>,
    airlineid: <span class="token string">'airline_596'</span>,
    destinationairport: <span class="token string">'ATL'</span>,
    distance: <span class="token number">2038.3535078909663</span>,
  <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span>
    airline: <span class="token string">'KL'</span>,
    airlineid: <span class="token string">'airline_3090'</span>,
    destinationairport: <span class="token string">'ATL'</span>,
    distance: <span class="token number">2038.3535078909663</span>,
  <span class="token punctuation">}</span>,
<span class="token punctuation">]</span>
</code></pre></div><p><a href="https://docs.couchbase.com/server/current/n1ql/n1ql-language-reference/collectionops.html#collection-op-every" target="_blank" rel="noopener noreferrer">EVERY<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is very similar to<code>ANY</code> with the main difference being that all the elements of the array must satisfy the defined condition. Let's see how it works:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Changing a little the above where expression definition:</span>
<span class="token keyword">const</span> whereExpr<span class="token operator">:</span> LogicalWhereExpr <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'route'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  $and<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> airline<span class="token operator">:</span> <span class="token punctuation">{</span> $eq<span class="token operator">:</span> <span class="token string">'KL'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> sourceairport<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token string">'ABQ'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> destinationairport<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'ATL'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      $every<span class="token operator">:</span> <span class="token punctuation">{</span>
        $expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> departure<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token string">'schedule'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'departure.utc'</span><span class="token operator">:</span> <span class="token punctuation">{</span> $gt<span class="token operator">:</span> <span class="token string">'00:35'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Building the query</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span>selectExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>whereExpr<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The resulting query would be:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> airline<span class="token punctuation">,</span> airlineid<span class="token punctuation">,</span> destinationairport<span class="token punctuation">,</span> distance
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&quot;route&quot;</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>
    airline <span class="token operator">=</span> <span class="token string">&quot;KL&quot;</span>
    <span class="token operator">AND</span> sourceairport <span class="token operator">LIKE</span> <span class="token string">&quot;ABQ&quot;</span>
    <span class="token operator">AND</span> destinationairport <span class="token operator">IN</span> <span class="token punctuation">[</span><span class="token string">&quot;ATL&quot;</span><span class="token punctuation">]</span>
    <span class="token operator">AND</span> EVERY departure <span class="token operator">IN</span> schedule SATISFIES departure<span class="token punctuation">.</span>utc <span class="token operator">&gt;</span> <span class="token string">&quot;00:35&quot;</span> <span class="token keyword">END</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now let's run the query:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token function">getDefaultInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> rows <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We would have as a result:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    airline: <span class="token string">'KL'</span>,
    airlineid: <span class="token string">'airline_3090'</span>,
    destinationairport: <span class="token string">'ATL'</span>,
    distance: <span class="token number">2038.3535078909663</span>,
  <span class="token punctuation">}</span>,
<span class="token punctuation">]</span>
</code></pre></div><h3 id="query-builder-model-find-method"><a href="#query-builder-model-find-method" class="header-anchor">#</a> Query Builder &amp; Model Find Method</h3> <p>Let's start from query:</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span> country<span class="token punctuation">,</span> icao<span class="token punctuation">,</span> name
<span class="token keyword">FROM</span> <span class="token punctuation">`</span>travel<span class="token operator">-</span>sample<span class="token punctuation">`</span>
<span class="token keyword">WHERE</span> <span class="token keyword">type</span> <span class="token operator">=</span> <span class="token string">&quot;airline&quot;</span>
  <span class="token operator">AND</span> <span class="token punctuation">(</span>country <span class="token operator">IN</span> <span class="token punctuation">[</span><span class="token string">&quot;United Kingdom&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;France&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token operator">AND</span> callsign <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
  <span class="token operator">AND</span> <span class="token keyword">ANY</span> description <span class="token keyword">WITHIN</span> <span class="token punctuation">[</span><span class="token string">&quot;EU&quot;</span><span class="token punctuation">]</span> SATISFIES icao
  <span class="token operator">LIKE</span> <span class="token string">&quot;%&quot;</span> <span class="token operator">||</span> description <span class="token keyword">END</span>
<span class="token keyword">LIMIT</span> <span class="token number">2</span>
</code></pre></div><p>Using Model find method</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Defining our SCHEMA</span>
<span class="token keyword">const</span> airlineSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  callsign<span class="token operator">:</span> String<span class="token punctuation">,</span>
  country<span class="token operator">:</span> String<span class="token punctuation">,</span>
  iata<span class="token operator">:</span> String<span class="token punctuation">,</span>
  icao<span class="token operator">:</span> String<span class="token punctuation">,</span>
  id<span class="token operator">:</span> Number<span class="token punctuation">,</span>
  name<span class="token operator">:</span> String<span class="token punctuation">,</span>
  type<span class="token operator">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Model Airline creation</span>
<span class="token keyword">const</span> Airline <span class="token operator">=</span> <span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'airline'</span><span class="token punctuation">,</span> airlineSchema<span class="token punctuation">,</span> <span class="token punctuation">{</span> modelKey<span class="token operator">:</span> <span class="token string">'type'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Start Ottoman instance</span>
<span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token function">getDefaultInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Our find method with a filter and options definitions</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> Airline<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'airline'</span><span class="token punctuation">,</span>
    $and<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> country<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'United Kingdom'</span><span class="token punctuation">,</span> <span class="token string">'France'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    callsign<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    $<span class="token builtin">any</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      $expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> description<span class="token operator">:</span> <span class="token punctuation">{</span> $within<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'EU'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span> icao<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'&quot;%&quot;||description'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> limit<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> select<span class="token operator">:</span> <span class="token string">'country,icao,name'</span><span class="token punctuation">,</span> lean<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Print output</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Via Query Builder</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Defining our query</span>
<span class="token keyword">const</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> select<span class="token operator">:</span> <span class="token string">'country,icao,name'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">'travel-sample'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">'airline'</span><span class="token punctuation">,</span>
    $and<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> country<span class="token operator">:</span> <span class="token punctuation">{</span> $<span class="token keyword">in</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'United Kingdom'</span><span class="token punctuation">,</span> <span class="token string">'France'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    callsign<span class="token operator">:</span> <span class="token punctuation">{</span> $isNotNull<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    $<span class="token builtin">any</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      $expr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> description<span class="token operator">:</span> <span class="token punctuation">{</span> $within<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'EU'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      $satisfies<span class="token operator">:</span> <span class="token punctuation">{</span> icao<span class="token operator">:</span> <span class="token punctuation">{</span> $like<span class="token operator">:</span> <span class="token punctuation">{</span> $field<span class="token operator">:</span> <span class="token string">'&quot;%&quot;||description'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Start Ottoman instance</span>
<span class="token keyword">const</span> ottoman <span class="token operator">=</span> <span class="token function">getDefaultInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Runing query</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> ottoman<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Print output</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>For above examples we get this output:</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    country: <span class="token string">'United Kingdom'</span>,
    icao: <span class="token string">'AEU'</span>,
    name: <span class="token string">'Astraeus'</span>
  <span class="token punctuation">}</span>,
  <span class="token punctuation">{</span>
    country: <span class="token string">'France'</span>,
    icao: <span class="token string">'REU'</span>,
    name: <span class="token string">'Air Austral'</span>
  <span class="token punctuation">}</span>,
<span class="token punctuation">]</span>
</code></pre></div><h2 id="n1ql-join-clause-structure"><a href="#n1ql-join-clause-structure" class="header-anchor">#</a> N1QL JOIN Clause Structure</h2> <p>Notice: Currently the JOIN clause is only supported in string format.</p> <p>See definition <a href="/classes/query.html#plainJoin">here</a></p> <p>The syntax of a JOIN clause in n1ql is documented <a href="https://docs.couchbase.com/server/6.5/n1ql/n1ql-language-reference/join.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="n1ql-group-by-clause-structure"><a href="#n1ql-group-by-clause-structure" class="header-anchor">#</a> N1QL GROUP BY Clause Structure</h2> <p>See definition <a href="/classes/query.html#groupby">here</a></p> <p>The syntax of a GROUP BY clause in n1ql is documented <a href="https://docs.couchbase.com/server/6.5/n1ql/n1ql-language-reference/groupby.html" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.291b5b6b.js" defer></script><script src="/assets/js/2.91685ef8.js" defer></script><script src="/assets/js/107.62aaa79a.js" defer></script>
  </body>
</html>
